<!doctype html>

<html>

<head>
    <title>IRISのグローバル変数を使ってグラフデータ表示</title>
    <!-- <script src="./cytoscape.js/dist/cytoscape.min.js"></script> -->
    <script src="https://cdn.bootcss.com/cytoscape/2.3.16/cytoscape.min.js"></script>
</head>

<style>
    #cy {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0px;
        left: 0px;
    }
</style>

<body>
    <div id="cy"></div>
    <script>
      //RESTでIRISにアクセス
      // IRISのユーザ名とパスワードの準備
      const json =""
      var username = "_SYSTEM"
      var password = "SYS"
      var a64 = btoa(`${username}:${password}`)
      //var url="http://localhost:52773/graph/correlation"
      var url="/graph/correlation"
      // RESTで場所を取得
      fetch(url, {
          method: "GET",
          headers:{
          "Accept":"application/json",
          "Authorization" : `Basic ${a64}`
          },
      }).then(function(Response) {
          console.log("status=" + Response.status);
          return Response.json();
      }).then(function(json) {
        console.log("取得結果=" +JSON.stringify(json));

        //内容要素を表現するCSS
        var style = [
          { selector: 'node', 
            css: {shape: 'hexagon','background-color': 'red',content: 'data(label)'}
          },
          { selector: 'edge', 
            css: {'width': 4, 'line-color': '#ccc','target-arrow-color': '#ccc','target-arrow-shape': 'triangle','curve-style': 'bezier'}
          } 
        ]

        //レイアウト設定
        var layout = {
          //グリッドレイアウトを適用する
          name : "breadthfirst"
        }

        var cy = cytoscape({
          container: document.getElementById('cy'),
          style: style,
          layout: layout,
        });

        cy.add(json);
        /*
        cy.style().selector("edge").style({
          'width': 4,
          'line-color': '#ccc',
          'target-arrow-color': '#ccc',
          'target-arrow-shape': 'triangle',
          'curve-style': 'bezier'
        });

        cy.style().selector("node").style({
          shape: 'hexagon',
          'background-color': 'red',
          label: 'data(label)',
          'font-size':"25pt"
        });

        cy.add(json);
        cy.layout({
          name: 'breadthfirst'
        }).run();
        */
      }).catch(function(err) {
          console.log("err="+err);
      });

    </script>
</body>
</html>